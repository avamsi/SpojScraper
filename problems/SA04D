<head>
<meta charset="utf-8">
</head>
<style type="text/css">
	a { text-decoration: none }
	p { line-height: 1.8; }
	th {text-align: left; }
</style>
<font face="verdana"><p>
<a href="http://www.spoj.com/problems/SA04D"target="_blank">View problem on Spoj</a><br>
<table width="100%" style="margin-top:10px">
<tr>
	<td>
		<h2>SPOJ Problem Set (classical)</h2>
				<h1>3306. Very Special Boxes </h1>
		<h2>Problem code: SA04D</h2>
	</td>
	</tr>
</table>

<p align="justify">
<p>
Special Box Company (SBC) is a small family-owned and family-run business which produces decorated carton boxes for wrapping gifts. The boxes are hand-made, produced individually from &#64257;ne materials. When accepting an order from a client, they always produce a few more boxes than needed, to keep a stock of boxes to be sold in the future, if needed. Over the years their stock has been growing, with boxes all over the place, and they decided they needed to organize it a bit more. They have therefore made a list registering the dimensions of every box in their stock.<br>
SBC has just received an order from a client that must be delivered tomorrow, so there is no time to produce new boxes. The client wants a certain number N of boxes all of the same size; each box will be used to pack one item of dimensions X, Y and Z. As the carton used in the
boxes is very thin, you may assume that a box of size (X, Y, Z) would &#64257;t perfectly the item the client wants to wrap. If there are not at least N boxes that &#64257;t perfectly, the client wants N boxes that &#64257;t the items as tightly as possible. The box size that &#64257;ts the items as tightly as possible is the one which minimizes the empty space when the item is put inside the box. An item can be rotated in any direction to be accomodated inside a box; therefore, a box of size(X, Y, Z) is as good as a box of size (Y, Z, X), for example.<br><br>
Can you help SBC &#64257;nding whether they can ful&#64257;ll the customer order?<br><br>

<h3>Input</h3>
<p>The input consists of several test cases. The &#64257;rst line of a test case contains two integers N and M, indicating respectively the number of boxes the client needs to buy (1 &#8804; N &#8804; 1500) and the number of boxes in the stock list (1 &#8804; M &#8804; 1500). The second line contains three integers X, Y and Z, representing the dimensions of the item the client wants to wrap (0 < X, Y, Z &#8804; 50). <br>
Each of the next M lines contains three integers A, B and C representing the dimensions of a box in the stock list (0 < A, B, C &#8804; 50). A test case with N = 0 indicates the end of the input. <br><br>
The input must be read from standard input.


<h3>Output</h3>
<p><p>
For each test case in the input your program must produce one line, containing either:<br><br>
-> The single word &#8216;impossible&#8217;, in case it is not possible to ful&#64257;ll the client&#8217;s order (because there are not at least N boxes of the same size in stock that can contain the item); or<br><br>
-> one integer V , which speci&#64257;es the volume of empty space left when one of the N items packed in one of the boxes chosen.<br />
<p><p>

<h3>Example</h3>

<pre>
<b>Input:</b>
1 1
2 4 3
2 3 4
2 6
3 1 3
7 4 7
10 8 2
2 8 10
6 2 9
7 7 4
6 2 9
1 1
3 3 3
1 1 1
0 0


<b>Output:</b>
0
99
impossible

</pre>


<hr>
<table border=0 cellspacing=0 cellpadding=0 align=left style="margin-bottom:10px" class="probleminfo">
<tr><td>Added by:</td><td><a href="/SPOJ/users/dilaang">Daniel GÃ³mez Didier</a></td></tr>
<tr><td>Date:</td><td>2008-11-07</td></tr>
<tr><td>Time limit:</td><td>0.435s-1.434s</td></tr>
<tr><td>Source limit:</td><td>50000B</td></tr>
<tr><td>Memory limit:</td><td>1536MB</td></tr>
	<tr>
		<td>Cluster:</td>
		<td>
							<a href="/clusters/" target="_blank">Cube (Intel Pentium G860 3GHz)</a>
					
		</td>
	</tr>
<tr><td>Languages:</td><td>All except: ERL JS SCM chicken </td></tr>
<tr><td>Resource:</td><td>ACM International Collegiate Programming Contest 2004 &#8211; Brazil Sub-Regional </td></tr>	
</table>
