<head>
<meta charset="utf-8">
</head>
<style type="text/css">
	a { text-decoration: none }
	p { line-height: 1.8; }
	th {text-align: left; }
</style>
<font face="verdana"><p>
<a href="http://www.spoj.com/problems/GNTFNTN"target="_blank">View problem on Spoj</a><br>
<table width="100%" style="margin-top:10px">
<tr>
	<td>
		<h2>SPOJ Problem Set (classical)</h2>
				<h1>8330. Giant fountain</h1>
		<h2>Problem code: GNTFNTN</h2>
	</td>
	</tr>
</table>

<p align="justify">
<p>The Dystopian government has installed a giant fountain in front of the parliament building. The fountain consists of N levels stacked one on top of the other and is situated on top of a large tank of infinite capacity. The levels of the fountain are numbered 1 to N from top to bottom. The top l<sub>1</sub> levels are identical with capacity c<sub>1</sub>, the next l<sub>2</sub> levels identical with capacity c<sub>2</sub>,... the final l<sub>K</sub> levels with capacity c<sub>K</sub>. Here l<sub>1</sub> + l<sub>2</sub> + ... l<sub>K</sub> = N.</p>
<p>When water is added to level i beyond its capacity, the excess water overflows to level i+1. Water overflowing from level N is collected in the tank. Water is added to the levels in the following fashion. First, w<sub>1</sub> amount of water is added to each level i such that s<sub>1</sub> &le; i &le; e<sub>1</sub>. Then w<sub>2</sub> amount of water is added to each s<sub>2</sub> &le; i &le; e<sub>2</sub>... Finally w<sub>M</sub> amount is added to s<sub>M</sub> &le; i &le; e<sub>M</sub>. Note that water might be added to the same level multiple times in this fashion.  You have to find out the amount of water that has overflowed to the tank at the bottom, and the total number of levels of the fountain that are completely filled</p>
<h3>Input</h3>
<p>The first line of the input contains T (&le;10), the number of test cases. Following this are the descriptions of the test cases.</p>
<p>The first line of the description of a test case contains space separated integers N (&le;2x10<sup>8</sup>), K (&le;2000) and M (&le;10<sup>4</sup>). Following this are K lines, each containing a space separated pair of integers. These are the (l<sub>i</sub>,c<sub>i</sub>) pair as explained in the problem statement. Here l<sub>1</sub> + l<sub>2</sub> + ... l<sub>K</sub> = N and c<sub>i</sub> &le; 10<sup>8</sup>. This is followed by M lines, each containing a space separated triplet of integers. These are (s<sub>i</sub>,e<sub>i</sub>,w<sub>i</sub>) as explained in the problem statement. 1 &le; s<sub>i</sub> &le; e<sub>i</sub> &le; N and w<sub>i</sub> &le; 10<sup>6</sup></p>
<h3>Output</h3>
<p>For each test case output a space separated pair of integers : The total amount of water that has overflowed to the tank and the number of levels of the fountain that are completely filled.</p>
<h3>Example</h3>
<pre><strong>Input:</strong>
1
10 2 1
5 6
5 3
3 9 5

<strong>Output:</strong>
5 5
</pre>

<hr>
<table border=0 cellspacing=0 cellpadding=0 align=left style="margin-bottom:10px" class="probleminfo">
<tr><td>Added by:</td><td><a href="/SPOJ/users/raziman">Raziman T V</a></td></tr>
<tr><td>Date:</td><td>2011-02-13</td></tr>
<tr><td>Time limit:</td><td>0.331s
</td></tr>
<tr><td>Source limit:</td><td>50000B</td></tr>
<tr><td>Memory limit:</td><td>1536MB</td></tr>
	<tr>
		<td>Cluster:</td>
		<td>
							<a href="/clusters/" target="_blank">Cube (Intel Pentium G860 3GHz)</a>
					
		</td>
	</tr>
<tr><td>Languages:</td><td>All except: SCM chicken </td></tr>
<tr><td>Resource:</td><td>IOPC2011</td></tr>	
</table>
