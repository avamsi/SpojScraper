<head>
<meta charset="utf-8">
</head>
<style type="text/css">
	a { text-decoration: none }
	p { line-height: 1.8; }
	th {text-align: left; }
</style>
<font face="verdana"><p>
<a href="http://www.spoj.com/problems/GNY07F"target="_blank">View problem on Spoj</a><br>
<table width="100%" style="margin-top:10px">
<tr>
	<td>
		<h2>SPOJ Problem Set (classical)</h2>
				<h1>2528. Monkey Vines</h1>
		<h2>Problem code: GNY07F</h2>
	</td>
	</tr>
</table>

<p align="justify">
<p>Deep in the Amazon jungle, exceptionally tall trees grow that support a rich biosphere of figs and
juniper bugs, which happen to be the culinary delight of brown monkeys.

<p>Reaching the canopy of these trees requires the monkeys to perform careful navigation through the
tall tree&#8217;s fragile vine system. These vines operate like a see-saw: an unbalancing of weight at any
vine junction would snap the vine from the tree, and the monkeys would plummet to the ground
below. The monkeys have figured out that if they work together to keep the vines properly balanced,
they can <i>all</i> feast on the figs and juniper bugs in the canopy of the trees.

<p>A <i>vine junction</i> supports exactly two <i>sub-vines</i>, each of which must contain the same number of
monkeys, or else the vine will break, leaving a pile of dead monkeys on the jungle ground. For
purposes of this problem, a <i>vine junction</i> is denoted by a pair of matching square brackets [ ], which
may contain nested information about junctions further down its <i>sub-vines</i>. The nesting of vines will
go no further than <b>25</b> levels deep.

<p><img align="center" src="https://www.spoj.pl/content/marcog:GNY07_monkeys.png">

<p>You will write a program that calculates the <i>minimum</i> number of monkeys required to balance a
particular vine configuration. There is <b>always</b> at least one monkey needed, and, multiple monkeys
may hang from the same vine.

<h3>Input</h3>
<p>The first line of input contains a single integer N, (1 &#8804; N &#8804; 1000) which is the number of datasets that
follow.
<p>Each dataset consists of a single line of input containing a vine configuration consisting of a string of
[ and ] characters as described above. The length of the string of [ and ] will be greater than or
equal to zero, and less than or equal to 150.

<h3>Output</h3>
<p>For each dataset, you should generate one line of output with the following values: The dataset
number as a decimal integer (start counting at one), a space, and the minimum number of monkeys
required to reach the canopy successfully. Assume that all the hanging vines are reachable from the
jungle floor, and that all monkeys jump on the vines at the same time.

<h3>Example</h3>

<pre>
<b>Input:</b>
3
[]

[[][[]]]

<b>Output:</b>
1 2
2 1
3 8
</pre>


<hr>
<table border=0 cellspacing=0 cellpadding=0 align=left style="margin-bottom:10px" class="probleminfo">
<tr><td>Added by:</td><td><a href="/SPOJ/users/marcog">Marco Gallotta</a></td></tr>
<tr><td>Date:</td><td>2008-03-11</td></tr>
<tr><td>Time limit:</td><td>12.85s
</td></tr>
<tr><td>Source limit:</td><td>50000B</td></tr>
<tr><td>Memory limit:</td><td>1536MB</td></tr>
	<tr>
		<td>Cluster:</td>
		<td>
							<a href="/clusters/" target="_blank">Cube (Intel Pentium G860 3GHz)</a>
					
		</td>
	</tr>
<tr><td>Languages:</td><td>All except: ERL JS NODEJS PERL 6 SCM chicken VB.net </td></tr>
<tr><td>Resource:</td><td>ACM Greater New York Regionals 2007</td></tr>	
</table>
