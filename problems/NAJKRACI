<head>
<meta charset="utf-8">
</head>
<style type="text/css">
	a { text-decoration: none }
	p { line-height: 1.8; }
	th {text-align: left; }
</style>
<font face="verdana"><p>
<a href="http://www.spoj.com/problems/NAJKRACI"target="_blank">View problem on Spoj</a><br>
<table width="100%" style="margin-top:10px">
<tr>
	<td>
		<h2>SPOJ Problem Set (classical)</h2>
				<h1>3545. Najkraci</h1>
		<h2>Problem code: NAJKRACI</h2>
	</td>
	</tr>
</table>

<p align="justify">
<p>A road network in a country consists of N cities and M one-way roads. The cities are numbered 1 through N. For each road we know the origin and destination cities, as well as its length.</p>

<p>We say that the road F is a continuation of road E if the destination city of road E is the same as the origin city of road F. A path from city A to city B is a sequence of road such that origin of the first road is city A, each other road is a continuation of the one before it, and the destination of the last road is city B. The length of the path is the sum of lengths of all roads in it.</p>

<p>A path from A to B is a shortest path if there is no other path from A to B that is shorter in length.</p>

<p>Your task is to, for each road, output how many different shortest paths containing that road, modulo 1 000 000 007.</p>

<h3>Input</h3>
<p>The first line contains two integers N and M (1 &#8804; N &#8804; 1500, 1 &#8804; M &#8804; 5000), the number of cities and roads.</p>

<p>Each of the following M lines contains three positive integers O, D and L. These represent a one-way road from city O to city D of length L. The numbers O and D will be different and L will be at most 10000.</p>

<h3>Output</h3>
<p>Output M integers, each on its own line &#8211; for each road, the number of different shortest paths containing it, modulo 1 000 000 007. The order of these numbers should match the order of roads in the input.</p>


<h3>Example</h3>

<pre>
<b>Input:</b>
4 4
1 2 5
2 3 5
3 4 5
1 4 8

<b>Output:</b>
2
3
2
1

<b>Input:</b>
5 8
1 2 20
1 3 2
2 3 2
4 2 3
4 2 3
3 4 5
4 3 5
5 4 20

<b>Output:</b>
0
4
6
6
6
7
2
6
</pre>

<p>Note: The test data for this problem consist of the official test cases from the contest, as well some cases of my own.</p>

<hr>
<table border=0 cellspacing=0 cellpadding=0 align=left style="margin-bottom:10px" class="probleminfo">
<tr><td>Added by:</td><td><a href="/SPOJ/users/neal_wu">Neal Wu</a></td></tr>
<tr><td>Date:</td><td>2008-12-17</td></tr>
<tr><td>Time limit:</td><td>0.177s-1.707s</td></tr>
<tr><td>Source limit:</td><td>50000B</td></tr>
<tr><td>Memory limit:</td><td>1536MB</td></tr>
	<tr>
		<td>Cluster:</td>
		<td>
							<a href="/clusters/" target="_blank">Cube (Intel Pentium G860 3GHz)</a>
					
		</td>
	</tr>
<tr><td>Languages:</td><td>All except: ERL JS SCM chicken </td></tr>
<tr><td>Resource:</td><td>Croatian Open 08/09 - Contest 3</td></tr>	
</table>
