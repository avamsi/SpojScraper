<head>
<meta charset="utf-8">
</head>
<style type="text/css">
	a { text-decoration: none }
	p { line-height: 1.8; }
	th {text-align: left; }
</style>
<font face="verdana"><p>
<a href="http://www.spoj.com/problems/TREE1"target="_blank">View problem on Spoj</a><br>
<table width="100%" style="margin-top:10px">
<tr>
	<td>
		<h2>SPOJ Problem Set (classical)</h2>
				<h1>71. Tree</h1>
		<h2>Problem code: TREE1</h2>
	</td>
	</tr>
</table>

<p align="justify">
<p>
	Consider an n-vertex binary search tree T containing n keys 1,2,...,n. A 
	permutation p = [p<sub>1</sub>,...,p<sub>n</sub>] of the integers 1,2,...,n is 
	said to be <i>consistent with the tree T</i> if the tree can be built from the 
	empty one as the result of inserting integers p<sub>1</sub>,p<sub>2</sub>,...,p<sub>n</sub>. 
	Find how many permutations are consistent with the tree T.
</p>
<h3>Illustration</h3>
<p>
	Exactly 2 permutations are consistent with the tree in the figure below.
</p>
<img src="/content/adrian:TREE1.png">
<h3>Task</h3>
<p>
	Write a program that for each data set from a sequence of several data sets:
</p>
<div align="justify">
	<ul>
		<li>
		reads from the input file a description of an input tree T,
		<li>
		computes the number of permutations consistent with T,
		<li>
			writes the result to output.</li>
	</ul>
</div>
<h3>Input</h3>
<p>
	The first line of the input file contains one positive integer d not larger 
	than 10. This is the number of data sets. The data sets follow. Each set of 
	data occupies two consecutive lines of the input file. The first line contains 
	only one integer n, 1 <= n <= 30. This is the number of vertices of the 
	tree. The second line contains a sequence of n integers separated by single 
	spaces. The integers are keys in the input tree given in the prefix order. The 
	first integer in the sequence is the key from the root of the tree. It is 
	followed by the keys from the left subtree written in the prefix order. The 
	sequence ends with the keys from the right subtree, also given in the prefix 
	order.
</p>
<h3>Output</h3>
<p>
	For each i = 1,...,d, your program should write to the i-th line of output 
	the number of permutations consistent with the tree described in the i-th 
	data set.
</p>
<h3>Example</h3>
<pre>
Sample input:

5 
3 
2 1 3 
3 
1 2 3 
1 
1 
4 
2 1 3 4 
4 
1 4 2 3 

Sample output:

2 
1 
1 
3 
1 
</pre>


<hr>
<table border=0 cellspacing=0 cellpadding=0 align=left style="margin-bottom:10px" class="probleminfo">
<tr><td>Added by:</td><td><a href="/SPOJ/users/adrian">Adrian Kosowski</a></td></tr>
<tr><td>Date:</td><td>2004-06-08</td></tr>
<tr><td>Time limit:</td><td>5s
</td></tr>
<tr><td>Source limit:</td><td>50000B</td></tr>
<tr><td>Memory limit:</td><td>1536MB</td></tr>
	<tr>
		<td>Cluster:</td>
		<td>
							<a href="/clusters/" target="_blank">Cube (Intel Pentium G860 3GHz)</a>
					
		</td>
	</tr>
<tr><td>Languages:</td><td>All except: NODEJS PERL 6 SCM chicken VB.net </td></tr>
<tr><td>Resource:</td><td>III Polish Collegiate Team Programming Contest (AMPPZ), 1998</td></tr>	
</table>
