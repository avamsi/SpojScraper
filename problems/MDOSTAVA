<head>
<meta charset="utf-8">
</head>
<style type="text/css">
	a { text-decoration: none }
	p { line-height: 1.8; }
	th {text-align: left; }
</style>
<font face="verdana"><p>
<a href="http://www.spoj.com/problems/MDOSTAVA"target="_blank">View problem on Spoj</a><br>
<table width="100%" style="margin-top:10px">
<tr>
	<td>
		<h2>SPOJ Problem Set (classical)</h2>
				<h1>4034. Pizza Delivery</h1>
		<h2>Problem code: MDOSTAVA</h2>
	</td>
	</tr>
</table>

<p align="justify">


<table class="problems" width="100%"><tr  class="navigation">
<td width="50%"><a href="/SPOJ/problems/MDOSTAVA/en/">English</a></td> 
<td width="50%"><a href="/SPOJ/problems/MDOSTAVA/vn/">Vietnamese</a></td> 
</tr></table>

</p><p>
Little Ivica recently got a job delivering pizzas for the most popular 
pizzeria in town.</p><p>
At the start of his work day, he receives a list with the locations to 
which he needs to deliver pizzas, inorder in which the locations are given.</p><p>
The city is divided into RÃ—C cells. The rows are numbered 1 through R, 
columns 1 through C.</p><p>
From every cell, it is possible to move to neighbouring cells to the 
left and right. Moving up or down is only allowed in the first and last
columns (columns 1 and C).</p><p>
The pizzeria is in the top left corner (1, 1) and this is the location Ivica
starts from. Ivica takes with him all the pizzas he will deliver that day 
so he does not have to return to the pizzeria between deliveries or
after the last delivery.</p><p>
For each location in the city, Ivica knows how much time he will spend every 
time he is in it (trying to get through the intersection, for example).
Write a program that calculates the smallest amount of time for Ivica to 
deliver all the pizzas.</p><p>

 
<h3>Input</h3>
</p><p> 
The first line contains the integers R and C (1 &#8804; R &#8804; 2000, 1 &#8804; C &#8804; 200),
the dimensions of the city.</p><p>
Each of the following R lines contains C integers. These are the times 
Ivica spends every time he enters a location. The times will be integers 
between 0 and 5000, inclusive.</p><p>
The next line contains an integer D (1 &#8804; D &#8804; 200 000), the number of 
pizza deliveries that day. (No, it's not unrealistically large at all.)
Each of the following D lines contains two integers A and B (1 &#8804; A &#8804; R, 
1 &#8804; B &#8804; C), the location to which a pizza must be delivered. The 
pizzas are given in the order in which they must be delivered. No
location will be given twice in a row.</p><p>
 
<h3>Output</h3>
</p><p>
Output the smallest amount of time for Ivica to deliver all the pizzas.
</p><p>
<h3>Sample</h3>
<pre>
input
3 3
1 8 2
2 3 2
1 0 1
3
1 3
3 3
2 2
output
17

input
2 5
0 0 0 0 0
1 4 2 3 2
4
1 5
2 2
2 5
2 1
output
9
</pre><p>
In the first example, the shortest path goes through the following locations:
(1, 1), (2, 1), (3, 1), (3, 2), (3, 3), (2, 3), (1, 3), (2, 3), (3, 3),
(2, 3) and (2, 2).
The locations in bold show where Mirko made deliveries.
The total time 
for the deliveries is 1+2+1+0+1+2+2+2+1+2+3=17.</p>


 

<hr>
<table border=0 cellspacing=0 cellpadding=0 align=left style="margin-bottom:10px" class="probleminfo">
<tr><td>Added by:</td><td><a href="/SPOJ/users/vdmedragon">~!(*(@*!@^&</a></td></tr>
<tr><td>Date:</td><td>2009-03-08</td></tr>
<tr><td>Time limit:</td><td>0.118s-0.229s</td></tr>
<tr><td>Source limit:</td><td>50000B</td></tr>
<tr><td>Memory limit:</td><td>1536MB</td></tr>
	<tr>
		<td>Cluster:</td>
		<td>
							<a href="/clusters/" target="_blank">Cube (Intel Pentium G860 3GHz)</a>
					
		</td>
	</tr>
<tr><td>Languages:</td><td>All except: ERL JS NODEJS PERL 6 SCM chicken VB.net </td></tr>
<tr><td>Resource:</td><td>COCI 6th 09</td></tr>	
</table>
