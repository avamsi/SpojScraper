<head>
<meta charset="utf-8">
</head>
<style type="text/css">
	a { text-decoration: none }
	p { line-height: 1.8; }
	th {text-align: left; }
</style>
<font face="verdana"><p>
<a href="http://www.spoj.com/problems/COURIER"target="_blank">View problem on Spoj</a><br>
<table width="100%" style="margin-top:10px">
<tr>
	<td>
		<h2>SPOJ Problem Set (classical)</h2>
				<h1>151. The Courier</h1>
		<h2>Problem code: COURIER</h2>
	</td>
	</tr>
</table>

<p align="justify">
<p>
	Byteland is a scarcely populated country, and residents of different cities 
	seldom communicate with each other. There is no regular postal service and 
	throughout most of the year a one-man courier establishment suffices to 
	transport all freight. However, on Christmas Day there is somewhat more work 
	for the courier than usual, and since he can only transport one parcel at a 
	time on his bicycle, he finds himself riding back and forth among the cities of 
	Byteland.
</p>
<p>
	The courier needs to schedule a route which would allow him to leave his home 
	city, perform the individual orders in arbitrary order (i.e. travel to the city 
	of the sender and transport the parcel to the city of the recipient, carrying 
	no more than one parcel at a time), and finally return home. All roads are 
	bi-directional, but not all cities are connected by roads directly; some pairs 
	of cities may be connected by more than one road. Knowing the lengths of all 
	the roads and the errands to be performed, determine the length of the shortest 
	possible cycling route for the courier.
</p>
<h3>Input</h3>
<p>
	The input begins with the integer t, the number of test cases. Then t test 
	cases follow.
</p>
<p>
	Each test case begins with a line containing three integers: n m b, denoting 
	the number of cities in Byteland, the number of roads, and the number of 
	the courier's home city, respectively (1<=n<=100,1<=b<=m<=10000). The 
	next m lines contain three integers each, the i-th being u<sub>i</sub> v<sub>i</sub>
	d<sub>i</sub>, which means that cities u<sub>i</sub> and v<sub>i</sub> are 
	connected by a road of length d<sub>i</sub> (1<=u<sub>i</sub>,v<sub>i</sub><=100, 
	1<=d<sub>i</sub><= 10000). The following line contains integer z - the 
	number of transport requests the courier has received (1<=z<=5). After that, z 
	lines with the description of the orders follow. Each consists of three 
	integers, the j-th being u<sub>j</sub> v<sub>j</sub> b<sub>j</sub>, which 
	signifies that b<sub>j</sub> parcels should be transported (individually) from 
	city u<sub>j</sub> to city v<sub>j</sub>. The sum of all b<sub>j</sub> does not 
	exceed 12.
</p>
<h3>Output</h3>
<p>
	For each test case output a line with a single integer - the length of the 
	shortest possible bicycle route for the courier.
</p>
<h3>Example</h3>
<pre><b><tt>Sample input:</tt></b>
1
5 7 2
1 2 7
1 3 5
1 5 2
2 4 10
2 5 1
3 4 3
3 5 4
3
1 4 2
5 3 1
5 1 1

<b><tt>Sample output:</tt></b>
43
</pre>


<hr>
<table border=0 cellspacing=0 cellpadding=0 align=left style="margin-bottom:10px" class="probleminfo">
<tr><td>Added by:</td><td><a href="/SPOJ/users/adrian">Adrian Kosowski</a></td></tr>
<tr><td>Date:</td><td>2004-07-28</td></tr>
<tr><td>Time limit:</td><td>7s
</td></tr>
<tr><td>Source limit:</td><td>50000B</td></tr>
<tr><td>Memory limit:</td><td>1536MB</td></tr>
	<tr>
		<td>Cluster:</td>
		<td>
							<a href="/clusters/" target="_blank">Cube (Intel Pentium G860 3GHz)</a>
					
		</td>
	</tr>
<tr><td>Languages:</td><td>All except: NODEJS PERL 6 SCM chicken VB.net </td></tr>
<tr><td>Resource:</td><td>based on a problem from the VII Polish Collegiate Team Programming Contest (AMPPZ), 2002</td></tr>	
</table>
