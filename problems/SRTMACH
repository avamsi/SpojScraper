<head>
<meta charset="utf-8">
</head>
<style type="text/css">
	a { text-decoration: none }
	p { line-height: 1.8; }
	th {text-align: left; }
</style>
<font face="verdana"><p>
<a href="http://www.spoj.com/problems/SRTMACH"target="_blank">View problem on Spoj</a><br>
<table width="100%" style="margin-top:10px">
<tr>
	<td>
		<h2>SPOJ Problem Set (classical)</h2>
				<h1>10510. Sorting Machine</h1>
		<h2>Problem code: SRTMACH</h2>
	</td>
	</tr>
</table>

<p align="justify">
<p>
Once upon a time, there was a machine, a sorting machine called Conchita, 
she was not very efficient,  most of the times she even couldn't sort the data correctly, 
and she only could process a list of 2<=N<=10 numbers,  her algorithm was the following, 
she was programmed with 2 permutations of N numbers,  each permutation F is given by N numbers, 
f1,f2...fN, such that 1<=fi<=N, fi!=fj for i!=j and means that if she apply F to the given list, 
she gets a list where the fi element, corresponds to the i element on the original list, 
then she forms a set of rearrangements of the original list, applying any of these permutations any number of times, in any order to the given list, 
so she forms all possible rearrangements using the given permutations, 
then she chooses to output the one that minimize the first element, 
if there is any tie, she chooses the one that minimize the second element and 
if there is any tie, she looks at the third element, and so on...
Her creator, a robot called Robotina, was very curious about Conchita's behavior,
she chooses an integer 1<=M<=10, an then she tries all possible lists, a1,a2..aN, 
such that 1<=ai<=M, and then for each input, she sends it to Conchita, 
and receives an output, then she asks herself, how many possible different outputs does 
Conchita can compute? (Two outputs are considered different if at least one element differs).</p>

<p>Your task, find this number MOD 98765431.</p>

<h3>Input</h3>
<p>
The first line of input contains an integer T<=10, the number of test cases. 
It is followed by T test cases, the first line of each test case contains 2 integer numbers, N, M, 
then is followed by K lines, each one consisting on N numbers.
</p>

<h3>Output</h3>
<p>For each case, output a single line consisting of the number of different outputs MOD 98765431.</p>

<h4>Input Sample</h4>
<pre>2<br />2 2<br />1 2<br />2 1<br />3 3<br />2 1 3<br />3 1 2
</pre>
<h4>Output sample</h4>
<pre>3<br />10
</pre>


<hr>
<table border=0 cellspacing=0 cellpadding=0 align=left style="margin-bottom:10px" class="probleminfo">
<tr><td>Added by:</td><td><a href="/SPOJ/users/paulo_costa">Paulo Costa</a></td></tr>
<tr><td>Date:</td><td>2012-01-30</td></tr>
<tr><td>Time limit:</td><td>0.930s
</td></tr>
<tr><td>Source limit:</td><td>50000B</td></tr>
<tr><td>Memory limit:</td><td>1536MB</td></tr>
	<tr>
		<td>Cluster:</td>
		<td>
							<a href="/clusters/" target="_blank">Cube (Intel Pentium G860 3GHz)</a>
					
		</td>
	</tr>
<tr><td>Languages:</td><td>All except: SCM chicken </td></tr>
<tr><td>Resource:</td><td>UGTO</td></tr>	
</table>
