<head>
<meta charset="utf-8">
</head>
<style type="text/css">
	a { text-decoration: none }
	p { line-height: 1.8; }
	th {text-align: left; }
</style>
<font face="verdana"><p>
<a href="http://www.spoj.com/problems/IITWPC4I"target="_blank">View problem on Spoj</a><br>
<table width="100%" style="margin-top:10px">
<tr>
	<td>
		<h2>SPOJ Problem Set (classical)</h2>
				<h1>18284. Petya and Repairment of Roads</h1>
		<h2>Problem code: IITWPC4I</h2>
	</td>
	</tr>
</table>

<p align="justify">
<p>Petya live in a city named Mayapur. As the in the morning, everybody likes to drink hot tea in bed. So the citizens needs milk to produce tea. For this purpose, they want that they should be able to go to atleast some milkmen using bi-directoinal roads. There are m roads in the city but all of them are currently unrepaired, hence not a state of use. <br />As Petya cares about his city a lot. He got a project about reparing these roads. So he has to select some roads to repair such that every citizen is connected to atleast one milkman. For reparing each road he needs to pay a cost. As he does not want to spend a lot of money in it, He wants to minimize the cost needed in this project. Note that a milkmen does not need to go to some other milkmen for milk as he can take milk from his own home.&nbsp;</p>
<p>Help Petya in finding out minimum cost needed to repair the roads in the above given way. If it is not possible for a citizen to connect to any of the milkmen, output "impossible" (without quotes).</p>
<h3>Input</h3>
<p>First line contains T : number of test cases. (1 &lt;= T &lt;= 100)</p>
<p>For each test case, First line contains two space seperated number n, m: number of citizens in Mayapur and m denotes number of unrepaired roads.</p>
<p>Next line contains n space integers either 0 or 1 which indices that citizen is milkmen or not[1 means he is a milkman]. (1 &lt;= n &lt;= 10^5)</p>
<p>Then For each of the next m lines, each line contains three space seperated integers u, v and c, denoting that there exists a unrepaired road between u and v such that cost of repairing of road is c. (1 &lt;= u, v &lt;= n and u != v) &nbsp;</p>
<p>(1 &lt;= m &lt;= min (n * (n - 1) / 2, 2 * 10^5). 1 &lt;= c &lt;= 10^9.)&nbsp;</p>
<h3>Output</h3>
<p>For each test case output the cost as required.</p>
<h3>Example</h3>
<pre><strong>Input:</strong>
1</pre>
<pre>5 7</pre>
<pre>0 1 0 1 0</pre>
<pre>1 2 11</pre>
<pre>1 3 1</pre>
<pre>1 5 17</pre>
<pre>2 3 1</pre>
<pre>3 5 18</pre>
<pre>4 5 3</pre>
<pre>2 4 5</pre>
<pre><strong>Output:</strong>
5
</pre>

<hr>
<table border=0 cellspacing=0 cellpadding=0 align=left style="margin-bottom:10px" class="probleminfo">
<tr><td>Added by:</td><td><a href="/SPOJ/users/dhinwa123">praveen123</a></td></tr>
<tr><td>Date:</td><td>2014-02-03</td></tr>
<tr><td>Time limit:</td><td>1s
</td></tr>
<tr><td>Source limit:</td><td>50000B</td></tr>
<tr><td>Memory limit:</td><td>1536MB</td></tr>
	<tr>
		<td>Cluster:</td>
		<td>
							<a href="/clusters/" target="_blank">Cube (Intel Pentium G860 3GHz)</a>
					
		</td>
	</tr>
<tr><td>Languages:</td><td>All except: SCM chicken </td></tr>
<tr><td>Resource:</td><td><a href="http://www2.cse.iitk.ac.in/judge/public/">IITK ACA CSE online judge </a></td></tr>	
</table>
