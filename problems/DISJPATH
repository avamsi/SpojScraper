<head>
<meta charset="utf-8">
</head>
<style type="text/css">
	a { text-decoration: none }
	p { line-height: 1.8; }
	th {text-align: left; }
</style>
<font face="verdana"><p>
<a href="http://www.spoj.com/problems/DISJPATH"target="_blank">View problem on Spoj</a><br>
<table width="100%" style="margin-top:10px">
<tr>
	<td>
		<h2>SPOJ Problem Set (classical)</h2>
				<h1>3579. Disjoint Paths</h1>
		<h2>Problem code: DISJPATH</h2>
	</td>
	</tr>
</table>

<p align="justify">
<p>One of your classes has K students in it who really don't like each other.  In fact, they dislike each other so much that they want to find routes to class that don't cross at any intersection so that they won't ever see each other outside of class.  Can you find such routes?

<h3>Input</h3>
<p>The input file will contain multiple cases. The first line of each
case is K N, where K is the number of routes you need
to find and N is the number of intersections in MIT's floor plan.
The intersections are numbered 1,...,N. This is followed
by N lines, one for each intersection, containing the indices of
the adjacent intersections, separated by spaces.  (This means that
if the line for intersection 2 contains a 3, then the line for
intersection 3 will contain a 2.)  Every intersection is adjacent
to at least one other intersection.

Each case is followed immediately by the next case. The end of the
input is indicated by a line containing only "0 0".

You may assume that 1 &#8804; K &#8804; 100 and 2 &#8804; N &#8804; 5000.

The students all start at intersection 1 and their class is at intersection 2.

<h3>Output</h3>
<p>For each case, output the case number, in the format "Case #:", followed by a newline.

If there are K non-intersecting routes from the start (1) to the end (2),
then this must be followed K lines, each one giving a list of corners,
in order, on one such route from 1 to 2.  If not, then output one line
with the word "Impossible".

Output a blank line after each test case.

<h3>Example</h3>

<pre>
<b>Input:</b>
3 5
3 4 5
3 4 5
1 2
1 2
1 2
4 5
3 4 5
3 4 5
1 2
1 2
1 2
0 0

<b>Output:</b>
Case 1:
1 3 2
1 4 2
1 5 2

Case 2:
Impossible
</pre>

<hr>
<table border=0 cellspacing=0 cellpadding=0 align=left style="margin-bottom:10px" class="probleminfo">
<tr><td>Added by:</td><td><a href="/SPOJ/users/minilek">Jelani Nelson (Minilek)</a></td></tr>
<tr><td>Date:</td><td>2008-12-22</td></tr>
<tr><td>Time limit:</td><td>30s
</td></tr>
<tr><td>Source limit:</td><td>50000B</td></tr>
<tr><td>Memory limit:</td><td>1536MB</td></tr>
	<tr>
		<td>Cluster:</td>
		<td>
							<a href="/clusters/" target="_blank">Cube (Intel Pentium G860 3GHz)</a>
					
		</td>
	</tr>
<tr><td>Languages:</td><td>All except: ERL JS NODEJS PERL 6 SCM chicken VB.net </td></tr>
<tr><td>Resource:</td><td><a href="http://web.mit.edu/acmicpc/www/2008/indiv/index.html">MIT Individual Contest 2008</a></td></tr>	
</table>
