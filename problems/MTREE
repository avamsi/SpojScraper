<head>
<meta charset="utf-8">
</head>
<style type="text/css">
	a { text-decoration: none }
	p { line-height: 1.8; }
	th {text-align: left; }
</style>
<font face="verdana"><p>
<a href="http://www.spoj.com/problems/MTREE"target="_blank">View problem on Spoj</a><br>
<table width="100%" style="margin-top:10px">
<tr>
	<td>
		<h2>SPOJ Problem Set (classical)</h2>
				<h1>3974. Another Tree Problem </h1>
		<h2>Problem code: MTREE</h2>
	</td>
	</tr>
</table>

<p align="justify">


<table class="problems" width="100%"><tr  class="navigation">
<td width="50%"><a href="/SPOJ/problems/MTREE/en/">English</a></td> 
<td width="50%"><a href="/SPOJ/problems/MTREE/vn/">Vietnamese</a></td> 
</tr></table>

<pre>
As  you  are  bound  to  know  by  now,  a  tree  is  a  connected  graph
consisting  of N  vertices  and N&#8722;1 edges. Trees  also  have  the  property
of  there  being  exactly  a  single  unique path  between  any  pair  of 
vertices. 
You will be given a tree in which every edge is assigned a weight &#8211; 
a non negative integer. The weight of a path is the product of the
weights of all edges on the path. The weight of the tree is the sum of 
the  weights  of  all  paths  in  the  tree.  Paths  going  in  opposite
directions  (A  to  B  and  B  to  A)  are considered the same and, when 
calculating the weight of a tree, are counted only once. 
Write a program that, given a tree, calculates its weight modulo 1000000007. </pre>
<h3>Input</h3>
<pre>
The first line contains the integer N (2 &#8804; N &#8804; 100 000), the number of vertices
in the tree. The vertices are numbered 1 to N. Each  of  the  following N&#8722;1
contains  three  integers A,  B  and W  (1 &#8804; A,  B &#8804; N,  0 &#8804; W &#8804;  1000) 
describing one edge. The edge connects vertices A and B, and its weight is W.
</pre>
<h3>Output</h3>
<pre>
Output the weight of the tree, modulo 1000000007. 
</pre>
<h3>Sample</h3>
<pre>input 
 
3 
3 2 100 
2 1 100 
 
output 
 
10200 

input 
 
4 
1 2 5 
1 3 5 
1 4 5 
 
output 
 
90 

input 
 
5 
1 2 2 
2 3 3 
4 3 2 
5 3 2 
 
output 
 
55
</pre>

 

<hr>
<table border=0 cellspacing=0 cellpadding=0 align=left style="margin-bottom:10px" class="probleminfo">
<tr><td>Added by:</td><td><a href="/SPOJ/users/vdmedragon">~!(*(@*!@^&</a></td></tr>
<tr><td>Date:</td><td>2009-02-28</td></tr>
<tr><td>Time limit:</td><td>0.113s-0.226s</td></tr>
<tr><td>Source limit:</td><td>50000B</td></tr>
<tr><td>Memory limit:</td><td>1536MB</td></tr>
	<tr>
		<td>Cluster:</td>
		<td>
							<a href="/clusters/" target="_blank">Cube (Intel Pentium G860 3GHz)</a>
					
		</td>
	</tr>
<tr><td>Languages:</td><td>All except: ERL JS NODEJS PERL 6 SCM chicken VB.net </td></tr>
<tr><td>Resource:</td><td>COI 08</td></tr>	
</table>
